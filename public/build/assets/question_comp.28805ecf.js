var oe=Object.defineProperty,ie=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var U=(e,r,l)=>r in e?oe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l,z=(e,r)=>{for(var l in r||(r={}))le.call(r,l)&&U(e,l,r[l]);if(J)for(var l of J(r))pe.call(r,l)&&U(e,l,r[l]);return e},F=(e,r)=>ie(e,ae(r));import{r as o}from"./vendor.5c57f7a1.js";import{R as X,D as Y,M as Z,q as j,l as ce}from"./App.73a128b6.js";import{a as v,j as t,F as de}from"./index.cc430573.js";import{g as ue,O as me}from"./old_version_question.fd349f74.js";const he=({option:e,index:r,position:l})=>t("div",{children:t("p",{children:v("label",{children:[t("input",{type:"checkbox",className:"filled-in",disabled:!0,checked:e.isCorrect,name:`options_${l}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},r),fe=({option:e,index:r,position:l})=>t("div",{children:t("p",{children:v("label",{children:[t("input",{disabled:!0,required:!0,checked:e.isCorrect,className:"with-gap",name:`options_${l}`,type:"radio"}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},r),ge=({question:e,position:r,isMarked:l})=>{const f=X(Y),s=o.exports.useMemo(()=>{var d,p;return((p=(d=e==null?void 0:e.options_next)==null?void 0:d.filter(a=>a.isCorrect))==null?void 0:p.length)||0},[e])>1||!1,m=o.exports.useRef(null);o.exports.useEffect(()=>{f&&f===e._id&&m.current&&window.scrollTo(0,m.current.offsetTop)},[f,e]),o.exports.useEffect(()=>{Z.Materialbox.init(document.querySelectorAll(".question-comp img"))},[]);const C=(()=>{let d=s?he:fe;return({position:p,index:a,option:g})=>t(d,{position:p,option:g,index:a},a)})();return v("div",{ref:m,style:{border:f===e._id?"1px solid red":"inherit",borderRadius:f===e._id?"4px":"inherit",padding:f===e._id?"4px":"inherit"},children:[t("span",{dangerouslySetInnerHTML:{__html:`
                    <div style="display:flex;flex-direction:row;">
                        <p style="margin-right:5px;">${r+1}.  </p><strong class="question-comp">${e.question}</strong>
                    </div>
                `}}),t("div",{style:{marginTop:"10px",marginLeft:"17px",marginBottom:"10px"},children:e.options_next&&e.options_next.map((d,p)=>C({position:r,option:d,index:p}))}),t("div",{style:{marginLeft:"17px",marginBottom:"10px"},hidden:!l,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                            ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},xe=({option:e,index:r,position:l})=>t("div",{children:t("p",{children:v("label",{children:[t("input",{type:"checkbox",checked:e.isCorrect,className:"filled-in",disabled:!0,required:!0,name:`sub_option_answer_${l}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},r),_e=({option:e,keyValue:r,position:l})=>t("p",{children:v("label",{children:[t("input",{disabled:!0,checked:e.isCorrect,required:!0,className:"with-gap",type:"radio",name:`sub_option_answer_${l}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})},r),be=({children:e,index:r,isMarked:l,isCorrect:f})=>v("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px",display:"flex",flexDirection:"row"},children:[r+1,".",t("div",{children:e})]}),Ce=({children:e,index:r})=>t("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px"},children:e}),ye=({question:e,index:r,AddInternalPaperContents:l,setAttempted:f,setCorrectAnswersCount:k,savedState:s,parentId:m})=>{const{attemptTree:S,currentPage:C,isMarked:d}=o.exports.useContext(j),[p,a]=o.exports.useState([]),[g,P]=o.exports.useState(!1),[A,Q]=o.exports.useState(0);o.exports.useEffect(()=>{let u=S.pages[C].find(T=>T.content.question===m);if(!u)return;let _=u.content.children.find(T=>T.question===e._id);if(!_)return;let h=(e.options||[]).filter((T,y)=>_?_.attempted_options.findIndex(I=>I.optionID===T._id||I.optionIndex===y)>-1:!1);P(_.status),a([...p,...h])},[]),o.exports.useEffect(()=>{if(d&&p.length>0){let u=p.every(x=>x.isCorrect);P(u)}},[d,p]),o.exports.useEffect(()=>{A>0&&l({status:p.length?p.every(u=>u.isCorrect):!1,question:e._id,attempted_options:p.map(u=>({optionID:u._id,optionIndex:e.options.findIndex(x=>x._id===u._id)}))})},[A]);const $=o.exports.useMemo(()=>{var u,x;return((x=(u=e==null?void 0:e.options)==null?void 0:u.filter(_=>_.isCorrect))==null?void 0:x.length)>1},[e]),O=e.question.trim().replace(/(<([^>]+)>)/ig,"").trim().length<=1,w=O?be:Ce,V=(()=>{let u=$?xe:_e;return({position:x,index:_,option:h,quesIndex:T})=>t(u,{keyValue:`sub_option_${_}_${T}`,position:x,option:h,index:_},`sub_option_${_}_${T}`)})();return v("div",{style:{marginLeft:"6px"},children:[t("span",{dangerouslySetInnerHTML:{__html:O?"":`
                        <div style="display:flex;flex-direction:row;">
                            <p style="margin-right:5px;">${r+1}.</p>
                            <p><strong>${e.question}</strong></p>
                        </div>
                    `}}),t(w,{index:r,isMarked:d,isCorrect:g,children:e.options.map((u,x)=>V({position:r,index:r,quesIndex:x,option:u}))}),t("div",{style:{marginLeft:"15px",marginBottom:"10px"},hidden:!d,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                                ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},ve=({parentId:e,position:r,sub_questions:l,setCorrectAnswersCount:f,setAttempted:k,savedChildren:s})=>{const{compSubQuestionPage:m}=o.exports.useContext(j),S=o.exports.useCallback(a=>s.find(g=>g.question===a)||null,[l]);let C=o.exports.useMemo(()=>ue(l||[]),[l]),d=C[m],p=C.slice(0,m).reduce((a,g)=>a+g.length,0);return t(de,{children:d.map((a,g)=>t(ye,{parentId:e,question:a,savedState:S(a._id),index:g+p+r,AddInternalPaperContents:P=>{},setAttempted:k,setCorrectAnswersCount:f},g))})},Se=({question:e,position:r,setAttempted:l,setCorrectAnswersCount:f})=>{const{currentPage:k}=o.exports.useContext(j),s=X(Y),[m,S]=o.exports.useState([]),[C,d]=o.exports.useState(e.question),[p,a]=o.exports.useState(-1);return o.exports.useEffect(()=>{Z.Materialbox.init(document.querySelectorAll(".question-comp img"))},[]),o.exports.useEffect(()=>{a(Math.random())},[k]),v("div",{style:{border:s===e._id?"1px solid red":"inherit",borderRadius:s===e._id?"4px":"inherit",padding:s===e._id?"4px":"inherit"},children:[t("span",{dangerouslySetInnerHTML:{__html:`<div class="question-comp">${C}</div>`}}),t("div",{style:{marginTop:"5px"},children:t(ve,{parentId:e._id,position:r,savedChildren:m,setAttempted:l,setCorrectAnswersCount:f,sub_questions:e.children||[]},p)})]})},Pe=({questions:e,alreadyDone:r,isKiswahili:l,wasTimed:f})=>{const{subject:k,currentPage:s,totalPages:m,attemptTree:S,questionsPerPage:C,numOfQuestions:d,isMarked:p,compSubQuestionPage:a,updatePageNumber:g,setIsMarked:P,setCurrentSubPage:A,updateStudentTreeContentAtAndMove:Q}=o.exports.useContext(j),[$,O]=o.exports.useState(!1),[w,D]=o.exports.useState(0),[V,u]=o.exports.useState(0),[x,_]=o.exports.useState([]),[h,T]=o.exports.useState(e.length===1&&e[0].questionType?e[0].questionType==="comprehension":!1),[y,I]=o.exports.useState({[s]:[]});let M=o.exports.useMemo(()=>{var n;return h?(n=e[0].children)==null?void 0:n.length:e.length},[s]),q=o.exports.useMemo(()=>h?Math.floor((M||0)/5)+((M||0)%5>0?1:0):0,[s]);const G=o.exports.useCallback(n=>n.reduce((i,c)=>{switch(c.questionType){case"normal":{i+=c.content.attempted_options.length>0?1:0;break}case"comprehension":{i+=c.content.children.slice(a*5,a*5+5).reduce((L,B)=>L+(B.attempted_options.length>0?1:0),0);break}}return i},0),[a]),ee=o.exports.useCallback(n=>n.reduce((i,c)=>{switch(c.questionType){case"comprehension":{i+=c.content.children.slice(0,a>0?(a-1)*5+5:a).reduce((L,B)=>L+(B.attempted_options.length>0?1:0),0);break}}return i},0),[a]),te=o.exports.useMemo(()=>h?ee(S.pages[s])+r+w===d:w+r===d,[w,s,C,d]);let N=o.exports.useMemo(()=>h?Math.floor((M||0)/5):1,[e]);const K=(n,i)=>{let c=y[s],b=c.findIndex(L=>L.content.question===n);if(b<0){I({[s]:[...c,i]});return}c[b]=i,I(F(z({},y),{[s]:c}))};o.exports.useMemo(()=>{if(h){let n=0,i=0;return a>N?(i=(M||0)%5,n=N):n=a,n*5+i}return 0},[e]),o.exports.useEffect(()=>{let n=S.pages[s];R(G(n)),I(F(z({},y),{[s]:n}))},[s]),o.exports.useEffect(()=>{R(G(S.pages[s]))},[a]),o.exports.useEffect(()=>{$&&ne()},[$]);const ne=()=>{if(h){let i=(M||0)%5,c=N+(i>0?1:0),b=a+1;if(b<c){A(b),Q(-1/0,b,s,y[s]);return}}let n=s+1;n<m&&Q(n,-1/0,s,y[s])},E=o.exports.useCallback(()=>n=>{_(i=>[...i,n])},[])(),R=n=>{D(w+n)},H=n=>{u(i=>i+n)},W=o.exports.useCallback(n=>(console.log(y),(y[s]||[]).find(c=>c.content.question===n)||null),[s]),re=(n,i)=>{switch(n.questionType){case"normal":return t(ge,{setAttempted:R,AddPageStudentPaperContent:K,setCorrectAnswersCount:H,AddLibraryPaperContents:E,question:n,savedQuestion:W(n._id),position:i+r,isMarked:p},i);case"comprehension":return t(Se,{setAttempted:R,index:i,savedQuestion:W(n._id),position:i+r,AddPageStudentPaperContent:K,question:n,AddLibraryPaperContents:E,setCorrectAnswersCount:H,isMarked:p},i);default:return t(me,{setAttempted:R,setCorrectAnswersCount:H,AddLibraryPaperContents:E,question:n,position:i+s*C,isMarked:p},i)}};return v("div",{style:{paddingTop:"0.3rem"},children:[v("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",border:"1px solid #d3d3d3",borderRadius:"2px",boxShadow:"0 4px 8px 0 rgba(0,0,0,0.2)",padding:"5px 6px",position:"sticky",top:62,zIndex:2},children:[t("button",{className:"waves-effect waves-light btn-small",disabled:s===0&&a===0,onClick:()=>{if(h&&a!==0){Q(-1/0,a>0?a-1:a,s,y[s]);return}let n=0,i=s>0?s-1:s,c=S.pages[i];if(c&&c[0].questionType==="comprehension"){let b=c[0].content.children.length;n=Math.floor((b||0)/5)+((b||0)%5>0?1:0)}n-=n>0?1:0,Q(i,n,s,y[s])},children:t("i",{className:"material-icons",children:"arrow_back"})}),t("div",{hidden:!p,children:t("button",{disabled:(()=>{if(h){let n=(M||0)%5,i=N+(n>0?1:0);return a+1===i&&s+1===m}return s+1===m})(),onClick:()=>{if(h){let i=a+1;if(i<q){A(i);return}}let n=s+1;n<m&&g(n)},className:"waves-effect waves-light z-depth-1 btn-small",children:t("i",{className:"material-icons",children:"arrow_forward"})})})]}),t("div",{id:"zoeziPaper",children:t(ce.Card,{style:{marginTop:"8px",border:"1px solid #d3d3d3"},header:v("div",{className:"card-image",children:[t("div",{className:"postergrad",children:t("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),t("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${k}`})]}),children:t("form",{onSubmit:n=>{if(n.preventDefault(),h)if(a<N){if(w!==5)return}else{let i=(M||0)%5;if(w!==i)return}else if(w!==M)return;O(!0),te&&P(!0)},children:e.map((n,i)=>re(n,i))})})})]})};export{Pe as default};
