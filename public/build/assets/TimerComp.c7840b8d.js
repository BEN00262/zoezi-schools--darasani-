import{r as c,R as $}from"./vendor.497bb12a.js";import{G as S,M as j}from"./App.9052e22c.js";import{a as I,j as s,F as N}from"./index.70091d13.js";import{c as k}from"./millisecondsToTime.26b2335e.js";const A=({option:t,_id:l,isCorrect:n,isMarked:a,index:p,position:h,setSuggestedAnswer:d,wasSelected:m})=>s("div",{children:s("p",{children:I("label",{children:[s("input",{type:"checkbox",className:"filled-in",disabled:a,checked:m||!1,onChange:x=>{d({option:t,isCorrect:n,_id:l})},name:`options_${h}`}),s("span",{className:a&&n?"green-text":"black-text",children:s("b",{children:s("span",{dangerouslySetInnerHTML:{__html:t}})})})]})})},p),E=({option:t,_id:l,isCorrect:n,isMarked:a,index:p,position:h,setSuggestedAnswer:d,wasSelected:m})=>s("div",{children:s("p",{children:I("label",{children:[s("input",{disabled:a,onChange:x=>{d({option:t,isCorrect:n,_id:l})},required:!0,checked:m||!1,className:"with-gap",name:`options_${h}`,type:"radio"}),s("span",{className:a&&n?"green-text":"black-text",children:s("b",{children:s("span",{dangerouslySetInnerHTML:{__html:t}})})})]})})},p),D=({question:t,position:l,isMarked:n,setAttempted:a,setCorrectAnswersCount:p,savedQuestion:h,AddPageStudentPaperContent:d})=>{const{currentPage:m,attemptTree:x}=c.exports.useContext(S),[i,u]=c.exports.useState([]),[T,b]=c.exports.useState(!1),y=c.exports.useMemo(()=>{var e,o;return((o=(e=t==null?void 0:t.options_next)==null?void 0:e.filter(r=>r.isCorrect))==null?void 0:o.length)||0},[t]),v=y>1||!1,w=e=>!!i.find(o=>o._id===e);c.exports.useEffect(()=>{const e=document.querySelectorAll(".question-comp img");j.Materialbox.init(e);const o=x.pages[m].find(f=>f.content.question===t._id);if(!o)return;const r=o.content,g=(t.options_next||[]).filter((f,C)=>r.attempted_options.findIndex(_=>_.optionID===f._id||_.optionIndex===C)>-1);b(g.length>0?g.every(f=>f.isCorrect):!1),u([...i,...g])},[]),c.exports.useEffect(()=>{i.length>0&&d(t._id,{questionType:"normal",content:{status:i.length>0?i.every(e=>e.isCorrect):!1,question:t._id,attempted_options:i.map(e=>({optionID:e._id,optionIndex:(t.options_next||[]).findIndex(o=>o._id===e._id)}))}})},[i]),c.exports.useEffect(()=>{if(n&&y===i.length){const e=i.length>0?i.every(o=>o.isCorrect):!1;b(e),p(e?1:0)}},[n]);const R=e=>{if(i.length||a(1),v){const o=i.findIndex(r=>r.option===e.option);if(o>-1){const r=[...i];r.splice(o),u(r),r.length||a(-1);return}u([...i,e]);return}u([e])},O=(()=>{const e=v?A:E;return({position:o,index:r,_id:g,option:f,isCorrect:C,wasSelected:_})=>s(e,{_id:g,setSuggestedAnswer:R,position:o,option:f,index:r,isCorrect:C,isMarked:n,wasSelected:_},r)})();return I("div",{children:[s("span",{dangerouslySetInnerHTML:{__html:`
                    <div style="display:flex;flex-direction:row;">
                        ${n?T?'<span style="color:green;">&#10004;</span>':'<span style="color:red;">&#10008;</span>':""} 
                        <p style="margin-right:5px;">${l+1}.  </p><strong class="question-comp">${t.question}</strong>
                    </div>
                `}}),s("div",{style:{marginTop:"10px",marginLeft:"17px",marginBottom:"10px"},children:t.options_next&&t.options_next.map(({option:e,isCorrect:o,_id:r},g)=>O({position:l,_id:r,option:e,index:g,isCorrect:o,wasSelected:w(r)}))}),s("div",{style:{marginLeft:"17px",marginBottom:"10px"},hidden:!n,children:s("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                            ${t.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},G=$.memo(({onTimeUp:t})=>{const{isMarked:l}=c.exports.useContext(S),[n,a]=c.exports.useState(+`${localStorage.getItem("remainingTime")}`||0),[p,h]=c.exports.useState(!1),d=c.exports.useMemo(()=>k(n<0?0:n),[n]);return c.exports.useEffect(()=>{if(n<=0){h(!0),l||t();return}localStorage.setItem("remainingTime",`${n>=0?n:0}`)},[n]),c.exports.useEffect(()=>{if(!p||!l){const m=setInterval(()=>{a(x=>x-1e3)},1e3);return()=>{clearInterval(m)}}},[p]),s(N,{children:s("button",{className:"waves-effect waves-light btn-small z-depth-0 white black-text",children:d})})});export{D as N,G as T};
