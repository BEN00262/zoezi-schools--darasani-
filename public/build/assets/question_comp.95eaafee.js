var te=Object.defineProperty,ne=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var H=(a,s,c)=>s in a?te(a,s,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[s]=c,N=(a,s)=>{for(var c in s||(s={}))re.call(s,c)&&H(a,c,s[c]);if($)for(var c of $(s))oe.call(s,c)&&H(a,c,s[c]);return a},M=(a,s)=>ne(a,se(s));import{r as i}from"./vendor.fd4def91.js";import{j as ae,l as L}from"./App.0f71c5c8.js";import{T as ie,O as le,C as ce,N as pe}from"./TimerComp.331a9431.js";import{a as _,F as ue,j as r}from"./index.0e329d27.js";import"./millisecondsToTime.6095074a.js";const Ae=({questions:a,alreadyDone:s,isKiswahili:c,wasTimed:O})=>{const{subject:G,currentPage:n,totalPages:v,attemptTree:m,questionsPerPage:Q,numOfQuestions:b,isMarked:f,compSubQuestionPage:l,updatePageNumber:q,setIsMarked:j,setCurrentSubPage:k,updateStudentTreeContentAtAndMove:w}=i.exports.useContext(ae),[I,B]=i.exports.useState(!1),[u,K]=i.exports.useState(0),[de,V]=i.exports.useState(0),[me,W]=i.exports.useState([]),[d,fe]=i.exports.useState(a.length===1&&a[0].questionType?a[0].questionType==="comprehension":!1),[h,P]=i.exports.useState({[n]:[]});let g=i.exports.useMemo(()=>{var e;return d?(e=a[0].children)==null?void 0:e.length:a.length},[n]),Z=i.exports.useMemo(()=>d?Math.floor((g||0)/5)+((g||0)%5>0?1:0):0,[n]);const R=e=>e.reduce((t,o)=>{switch(o.questionType){case"normal":{t+=o.content.attempted_options.length>0?1:0;break}case"comprehension":{t+=o.content.children.slice(l*5,l*5+5).reduce((A,T)=>A+(T.attempted_options.length>0?1:0),0);break}}return t},0),z=e=>e.reduce((t,o)=>{switch(o.questionType){case"comprehension":{t+=o.content.children.slice(0,l>0?(l-1)*5+5:l).reduce((A,T)=>A+(T.attempted_options.length>0?1:0),0);break}}return t},0),J=i.exports.useMemo(()=>d?z(m.pages[n])+s+u:u+s,[u,n]),E=i.exports.useMemo(()=>d?z(m.pages[n])+s+u===b:u+s===b,[u,n,Q,b]);let x=i.exports.useMemo(()=>d?Math.floor((g||0)/5):1,[a]);const F=(e,t)=>{let o=h[n],p=o.findIndex(A=>A.content.question===e);if(p<0){P({[n]:[...o,t]});return}o[p]=t,P(M(N({},h),{[n]:o}))},X=i.exports.useMemo(()=>{if(d){let e=0,t=0;return l>x?(t=(g||0)%5,e=x):e=l,e*5+t}return 0},[a]);i.exports.useEffect(()=>{let e=m.pages[n];C(R(e)),P(M(N({},h),{[n]:e}))},[n]),i.exports.useEffect(()=>{C(R(m.pages[n]))},[l]),i.exports.useEffect(()=>{I&&Y()},[I]);const Y=()=>{if(d){let t=(g||0)%5,o=x+(t>0?1:0),p=l+1;if(p<o){k(p),w(-1/0,p,n,h[n]);return}}let e=n+1;e<v&&w(e,-1/0,n,h[n])},S=i.exports.useCallback(()=>e=>{W(t=>[...t,e])},[])(),C=e=>{K(u+e)},y=e=>{V(t=>t+e)},U=i.exports.useCallback(e=>h[n].find(o=>o.content.question===e)||null,[n]),D=(e,t)=>{switch(e.questionType){case"normal":return r(pe,{setAttempted:C,AddPageStudentPaperContent:F,setCorrectAnswersCount:y,AddLibraryPaperContents:S,question:e,savedQuestion:U(e._id),position:t+s,isMarked:f},t);case"comprehension":return r(ce,{setAttempted:C,index:t,savedQuestion:U(e._id),position:t+s,AddPageStudentPaperContent:F,question:e,AddLibraryPaperContents:S,setCorrectAnswersCount:y,isMarked:f},t);default:return r(le,{setAttempted:C,setCorrectAnswersCount:y,AddLibraryPaperContents:S,question:e,position:t+n*Q,isMarked:f},t)}};return _(ue,{children:[_("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",borderRadius:"2px",boxShadow:"0 4px 8px 0 rgba(0,0,0,0.2)",padding:"5px 6px",position:"sticky",top:56.2,zIndex:2},children:[r("button",{className:"waves-effect waves-light btn-small",disabled:n===0&&l===0,onClick:()=>{if(d&&l!==0){w(-1/0,l>0?l-1:l,n,h[n]);return}let e=0,t=n>0?n-1:n,o=m.pages[t];if(o&&o[0].questionType==="comprehension"){let p=o[0].content.children.length;e=Math.floor((p||0)/5)+((p||0)%5>0?1:0)}e-=e>0?1:0,w(t,e,n,h[n])},children:r("i",{className:"material-icons",children:"arrow_back"})}),r("div",{className:"white",hidden:!f,style:{alignSelf:"center",padding:"5px",borderRadius:"3px",border:"1px solid #d3d3d3"},children:r("b",{children:_("span",{children:[c?"ALAMA":"SCORE"," : ",`${m.score.passed}/${b}`," ",_("span",{style:{fontFamily:"'Abril Fatface', cursive",color:"red"},children:["( ",Math.ceil(m.score.passed/m.score.total*100),"% )"]})]})})}),f?null:O?r(ie,{onTimeUp:()=>{j(!0)}}):r("input",{disabled:!0,type:"range",min:"0",value:`${J}`,max:b,style:{flex:1,marginRight:"3px",alignSelf:"center",background:"#000"}}),r("div",{hidden:f,className:"teal white-text z-depth-1",style:{alignSelf:"center",padding:"5px",borderRadius:"4px"},children:r("b",{children:`${u+s+X}/${b}`})}),r("div",{hidden:!f,children:r("button",{disabled:(()=>{if(d){let e=(g||0)%5,t=x+(e>0?1:0);return l+1===t&&n+1===v}return n+1===v})(),onClick:()=>{if(d){let t=l+1;if(t<Z){k(t);return}}let e=n+1;e<v&&q(e)},className:"waves-effect waves-light z-depth-1 btn-small",children:r("i",{className:"material-icons",children:"arrow_forward"})})})]}),r("div",{id:"zoeziPaper",children:r(L.Card,{style:{marginTop:"13px"},header:_("div",{className:"card-image",children:[r("div",{className:"postergrad",children:r("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),r("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${G}`})]}),children:_("form",{onSubmit:e=>{if(e.preventDefault(),d)if(l<x){if(u!==5)return}else{let t=(g||0)%5;if(u!==t)return}else if(u!==g)return;B(!0),E&&j(!0)},children:[a.map((e,t)=>D(e,t)),r(L.Button,{node:"button",waves:"light",small:!0,style:{marginTop:"15px"},disabled:f,children:E?c?"SAHIHISHA KARATASI":"MARK PAPER":c?"GEUZA UKURUSA":"TURN PAGE"})]})})})]})};export{Ae as default};
