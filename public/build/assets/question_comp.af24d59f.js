var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var F=(l,n,p)=>n in l?ee(l,n,{enumerable:!0,configurable:!0,writable:!0,value:p}):l[n]=p,N=(l,n)=>{for(var p in n||(n={}))ne.call(n,p)&&F(l,p,n[p]);if(E)for(var p of E(n))re.call(n,p)&&F(l,p,n[p]);return l},k=(l,n)=>te(l,se(n));import{r as o}from"./vendor.5c57f7a1.js";import{q as oe,l as ie}from"./App.73a128b6.js";import{T as ae,N as le}from"./TimerComp.80180168.js";import{O as ce,C as pe}from"./old_version_question.fd349f74.js";import{a as v,j as i}from"./index.cc430573.js";import"./millisecondsToTime.6095074a.js";const ve=({questions:l,alreadyDone:n,isKiswahili:p,wasTimed:L})=>{const{subject:O,currentPage:s,totalPages:w,attemptTree:f,questionsPerPage:Q,numOfQuestions:b,isMarked:g,compSubQuestionPage:a,updatePageNumber:W,setIsMarked:M,setCurrentSubPage:j,updateStudentTreeContentAtAndMove:y}=o.exports.useContext(oe),[I,G]=o.exports.useState(!1),[u,H]=o.exports.useState(0),[ue,U]=o.exports.useState(0),[de,V]=o.exports.useState([]),[d,me]=o.exports.useState(l.length===1&&l[0].questionType?l[0].questionType==="comprehension":!1),[m,P]=o.exports.useState({[s]:[]});let h=o.exports.useMemo(()=>{var e;return d?(e=l[0].children)==null?void 0:e.length:l.length},[s]),B=o.exports.useMemo(()=>d?Math.floor((h||0)/5)+((h||0)%5>0?1:0):0,[s]);const z=o.exports.useCallback(e=>e.reduce((t,r)=>{switch(r.questionType){case"normal":{t+=r.content.attempted_options.length>0?1:0;break}case"comprehension":{t+=r.content.children.slice(a*5,a*5+5).reduce((C,A)=>C+(A.attempted_options.length>0?1:0),0);break}}return t},0),[a]),$=o.exports.useCallback(e=>e.reduce((t,r)=>{switch(r.questionType){case"comprehension":{t+=r.content.children.slice(0,a>0?(a-1)*5+5:a).reduce((C,A)=>C+(A.attempted_options.length>0?1:0),0);break}}return t},0),[a]),J=o.exports.useMemo(()=>d?$(f.pages[s])+n+u:u+n,[u,s]),K=o.exports.useMemo(()=>d?$(f.pages[s])+n+u===b:u+n===b,[u,s,Q,b]);let _=o.exports.useMemo(()=>d?Math.floor((h||0)/5):1,[l]);const R=(e,t)=>{let r=m[s],c=r.findIndex(C=>C.content.question===e);if(c<0){P({[s]:[...r,t]});return}r[c]=t,P(k(N({},m),{[s]:r}))},X=o.exports.useMemo(()=>{if(d){let e=0,t=0;return a>_?(t=(h||0)%5,e=_):e=a,e*5+t}return 0},[l]);o.exports.useEffect(()=>{let e=f.pages[s];x(z(e)),P(k(N({},m),{[s]:e}))},[s]),o.exports.useEffect(()=>{x(z(f.pages[s]))},[a]),o.exports.useEffect(()=>{I&&Y()},[I]);const Y=()=>{if(d){let t=(h||0)%5,r=_+(t>0?1:0),c=a+1;if(c<r){console.log("[*] We are here ---> ",c,r),j(c),y(-1/0,c,s,m[s]);return}}let e=s+1;e<w&&y(e,-1/0,s,m[s])},T=o.exports.useCallback(()=>e=>{V(t=>[...t,e])},[])(),x=e=>{H(u+e)},S=e=>{U(t=>t+e)},q=o.exports.useCallback(e=>(console.log(m),(m[s]||[]).find(r=>r.content.question===e)||null),[s]),Z=(e,t)=>{switch(e.questionType){case"normal":return i(le,{setAttempted:x,AddPageStudentPaperContent:R,setCorrectAnswersCount:S,AddLibraryPaperContents:T,question:e,savedQuestion:q(e._id),position:t+n,isMarked:g},t);case"comprehension":return i(pe,{setAttempted:x,index:t,savedQuestion:q(e._id),position:t+n,AddPageStudentPaperContent:R,question:e,AddLibraryPaperContents:T,setCorrectAnswersCount:S,isMarked:g},t);default:return i(ce,{setAttempted:x,setCorrectAnswersCount:S,AddLibraryPaperContents:T,question:e,position:t+s*Q,isMarked:g},t)}};return v("div",{style:{paddingTop:"0.3rem"},children:[v("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",border:"1px solid #d3d3d3",borderRadius:"2px",boxShadow:"0 4px 8px 0 rgba(0,0,0,0.2)",padding:"5px 6px",position:"sticky",top:62,zIndex:2},children:[i("button",{className:"waves-effect waves-light btn-small",disabled:s===0&&a===0,onClick:()=>{if(d&&a!==0){y(-1/0,a>0?a-1:a,s,m[s]);return}let e=0,t=s>0?s-1:s,r=f.pages[t];if(r&&r[0].questionType==="comprehension"){let c=r[0].content.children.length;e=Math.floor((c||0)/5)+((c||0)%5>0?1:0)}e-=e>0?1:0,y(t,e,s,m[s])},children:i("i",{className:"material-icons",children:"arrow_back"})}),i("div",{className:"white",hidden:!g,style:{alignSelf:"center",padding:"5px",borderRadius:"3px",border:"1px solid #d3d3d3"},children:i("b",{children:v("span",{children:[p?"ALAMA":"SCORE"," : ",`${f.score.passed}/${b}`," ",v("span",{style:{fontFamily:"'Abril Fatface', cursive",color:"red"},children:["( ",Math.ceil(f.score.passed/f.score.total*100),"% )"]})]})})}),g?null:L?i(ae,{onTimeUp:()=>{M(!0)}}):i("input",{disabled:!0,type:"range",min:"0",value:`${J}`,max:b,style:{flex:1,marginRight:"3px",alignSelf:"center",background:"#000"}}),i("div",{hidden:g,className:"teal white-text z-depth-1",style:{alignSelf:"center",padding:"5px",borderRadius:"4px"},children:i("b",{children:`${u+n+X}/${b}`})}),i("div",{hidden:!g,children:i("button",{disabled:(()=>{if(d){let e=(h||0)%5,t=_+(e>0?1:0);return a+1===t&&s+1===w}return s+1===w})(),onClick:()=>{if(d){let t=a+1;if(t<B){j(t);return}}let e=s+1;e<w&&W(e)},className:"waves-effect waves-light z-depth-1 btn-small",children:i("i",{className:"material-icons",children:"arrow_forward"})})})]}),i("div",{id:"zoeziPaper",children:i(ie.Card,{style:{marginTop:"8px",border:"1px solid #d3d3d3"},header:v("div",{className:"card-image",children:[i("div",{className:"postergrad",children:i("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),i("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${O}`})]}),children:i("form",{onSubmit:e=>{if(e.preventDefault(),d)if(a<_){if(u!==5)return}else{let t=(h||0)%5;if(u!==t)return}else if(u!==h)return;G(!0),K&&M(!0)},children:l.map((e,t)=>Z(e,t))})})})]})};export{ve as default};
