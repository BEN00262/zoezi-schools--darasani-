var oe=Object.defineProperty,ie=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var U=(e,s,c)=>s in e?oe(e,s,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[s]=c,z=(e,s)=>{for(var c in s||(s={}))ce.call(s,c)&&U(e,c,s[c]);if(J)for(var c of J(s))pe.call(s,c)&&U(e,c,s[c]);return e},F=(e,s)=>ie(e,ae(s));import{r as o}from"./vendor.497bb12a.js";import{R as X,D as Y,M as Z,G as j,l as de}from"./App.fdb277d2.js";import{a as v,j as t,F as le}from"./index.d3bdb59a.js";import{g as ue,O as me}from"./old_version_question.c53cf162.js";const he=({option:e,index:s,position:c})=>t("div",{children:t("p",{children:v("label",{children:[t("input",{type:"checkbox",className:"filled-in",disabled:!0,checked:e.isCorrect,name:`options_${c}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},s),fe=({option:e,index:s,position:c})=>t("div",{children:t("p",{children:v("label",{children:[t("input",{disabled:!0,required:!0,checked:e.isCorrect,className:"with-gap",name:`options_${c}`,type:"radio"}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},s),ge=({question:e,position:s,isMarked:c})=>{const f=X(Y),r=o.exports.useMemo(()=>{var l,p;return((p=(l=e==null?void 0:e.options_next)==null?void 0:l.filter(a=>a.isCorrect))==null?void 0:p.length)||0},[e])>1||!1,m=o.exports.useRef(null);o.exports.useEffect(()=>{f&&f===e._id&&m.current&&window.scrollTo(0,m.current.offsetTop)},[f,e]),o.exports.useEffect(()=>{Z.Materialbox.init(document.querySelectorAll(".question-comp img"))},[]);const C=(()=>{const l=r?he:fe;return({position:p,index:a,option:g})=>t(l,{position:p,option:g,index:a},a)})();return v("div",{ref:m,style:{border:f===e._id?"1px solid red":"inherit",borderRadius:f===e._id?"4px":"inherit",padding:f===e._id?"4px":"inherit"},children:[t("span",{dangerouslySetInnerHTML:{__html:`
                    <div style="display:flex;flex-direction:row;">
                        <p style="margin-right:5px;">${s+1}.  </p><strong class="question-comp">${e.question}</strong>
                    </div>
                `}}),t("div",{style:{marginTop:"10px",marginLeft:"17px",marginBottom:"10px"},children:e.options_next&&e.options_next.map((l,p)=>C({position:s,option:l,index:p}))}),t("div",{style:{marginLeft:"17px",marginBottom:"10px"},hidden:!c,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                            ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},xe=({option:e,index:s,position:c})=>t("div",{children:t("p",{children:v("label",{children:[t("input",{type:"checkbox",checked:e.isCorrect,className:"filled-in",disabled:!0,required:!0,name:`sub_option_answer_${c}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},s),_e=({option:e,keyValue:s,position:c})=>t("p",{children:v("label",{children:[t("input",{disabled:!0,checked:e.isCorrect,required:!0,className:"with-gap",type:"radio",name:`sub_option_answer_${c}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})},s),be=({children:e,index:s,isMarked:c,isCorrect:f})=>v("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px",display:"flex",flexDirection:"row"},children:[s+1,".",t("div",{children:e})]}),Ce=({children:e,index:s})=>t("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px"},children:e}),ye=({question:e,index:s,AddInternalPaperContents:c,setAttempted:f,setCorrectAnswersCount:k,savedState:r,parentId:m})=>{const{attemptTree:S,currentPage:C,isMarked:l}=o.exports.useContext(j),[p,a]=o.exports.useState([]),[g,P]=o.exports.useState(!1),[A,Q]=o.exports.useState(0);o.exports.useEffect(()=>{const u=S.pages[C].find(T=>T.content.question===m);if(!u)return;const _=u.content.children.find(T=>T.question===e._id);if(!_)return;const h=(e.options||[]).filter((T,y)=>_?_.attempted_options.findIndex(I=>I.optionID===T._id||I.optionIndex===y)>-1:!1);P(_.status),a([...p,...h])},[]),o.exports.useEffect(()=>{if(l&&p.length>0){const u=p.every(x=>x.isCorrect);P(u)}},[l,p]),o.exports.useEffect(()=>{A>0&&c({status:p.length?p.every(u=>u.isCorrect):!1,question:e._id,attempted_options:p.map(u=>({optionID:u._id,optionIndex:e.options.findIndex(x=>x._id===u._id)}))})},[A]);const $=o.exports.useMemo(()=>{var u,x;return((x=(u=e==null?void 0:e.options)==null?void 0:u.filter(_=>_.isCorrect))==null?void 0:x.length)>1},[e]),O=e.question.trim().replace(/(<([^>]+)>)/ig,"").trim().length<=1,w=O?be:Ce,G=(()=>{const u=$?xe:_e;return({position:x,index:_,option:h,quesIndex:T})=>t(u,{keyValue:`sub_option_${_}_${T}`,position:x,option:h,index:_},`sub_option_${_}_${T}`)})();return v("div",{style:{marginLeft:"6px"},children:[t("span",{dangerouslySetInnerHTML:{__html:O?"":`
                        <div style="display:flex;flex-direction:row;">
                            <p style="margin-right:5px;">${s+1}.</p>
                            <p><strong>${e.question}</strong></p>
                        </div>
                    `}}),t(w,{index:s,isMarked:l,isCorrect:g,children:e.options.map((u,x)=>G({position:s,index:s,quesIndex:x,option:u}))}),t("div",{style:{marginLeft:"15px",marginBottom:"10px"},hidden:!l,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                                ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},ve=({parentId:e,position:s,sub_questions:c,setCorrectAnswersCount:f,setAttempted:k,savedChildren:r})=>{const{compSubQuestionPage:m}=o.exports.useContext(j),S=o.exports.useCallback(a=>r.find(g=>g.question===a)||null,[c]),C=o.exports.useMemo(()=>ue(c||[]),[c]),l=C[m],p=C.slice(0,m).reduce((a,g)=>a+g.length,0);return t(le,{children:l.map((a,g)=>t(ye,{parentId:e,question:a,savedState:S(a._id),index:g+p+s,AddInternalPaperContents:P=>{},setAttempted:k,setCorrectAnswersCount:f},g))})},Se=({question:e,position:s,setAttempted:c,setCorrectAnswersCount:f})=>{const{currentPage:k}=o.exports.useContext(j),r=X(Y),[m,S]=o.exports.useState([]),[C,l]=o.exports.useState(e.question),[p,a]=o.exports.useState(-1);return o.exports.useEffect(()=>{Z.Materialbox.init(document.querySelectorAll(".question-comp img"))},[]),o.exports.useEffect(()=>{a(Math.random())},[k]),v("div",{style:{border:r===e._id?"1px solid red":"inherit",borderRadius:r===e._id?"4px":"inherit",padding:r===e._id?"4px":"inherit"},children:[t("span",{dangerouslySetInnerHTML:{__html:`<div class="question-comp">${C}</div>`}}),t("div",{style:{marginTop:"5px"},children:t(ve,{parentId:e._id,position:s,savedChildren:m,setAttempted:c,setCorrectAnswersCount:f,sub_questions:e.children||[]},p)})]})},Pe=({questions:e,alreadyDone:s,isKiswahili:c,wasTimed:f})=>{const{subject:k,currentPage:r,totalPages:m,attemptTree:S,questionsPerPage:C,numOfQuestions:l,isMarked:p,compSubQuestionPage:a,updatePageNumber:g,setIsMarked:P,setCurrentSubPage:A,updateStudentTreeContentAtAndMove:Q}=o.exports.useContext(j),[$,O]=o.exports.useState(!1),[w,D]=o.exports.useState(0),[G,u]=o.exports.useState(0),[x,_]=o.exports.useState([]),[h,T]=o.exports.useState(e.length===1&&e[0].questionType?e[0].questionType==="comprehension":!1),[y,I]=o.exports.useState({[r]:[]}),M=o.exports.useMemo(()=>{var n;return h?(n=e[0].children)==null?void 0:n.length:e.length},[r]),q=o.exports.useMemo(()=>h?Math.floor((M||0)/5)+((M||0)%5>0?1:0):0,[r]),V=o.exports.useCallback(n=>n.reduce((i,d)=>{switch(d.questionType){case"normal":{i+=d.content.attempted_options.length>0?1:0;break}case"comprehension":{i+=d.content.children.slice(a*5,a*5+5).reduce((L,B)=>L+(B.attempted_options.length>0?1:0),0);break}}return i},0),[a]),ee=o.exports.useCallback(n=>n.reduce((i,d)=>{switch(d.questionType){case"comprehension":{i+=d.content.children.slice(0,a>0?(a-1)*5+5:a).reduce((L,B)=>L+(B.attempted_options.length>0?1:0),0);break}}return i},0),[a]),te=o.exports.useMemo(()=>h?ee(S.pages[r])+s+w===l:w+s===l,[w,r,C,l]),N=o.exports.useMemo(()=>h?Math.floor((M||0)/5):1,[e]),K=(n,i)=>{const d=y[r],b=d.findIndex(L=>L.content.question===n);if(b<0){I({[r]:[...d,i]});return}d[b]=i,I(F(z({},y),{[r]:d}))};o.exports.useMemo(()=>{if(h){let n=0,i=0;return a>N?(i=(M||0)%5,n=N):n=a,n*5+i}return 0},[e]),o.exports.useEffect(()=>{const n=S.pages[r];R(V(n)),I(F(z({},y),{[r]:n}))},[r]),o.exports.useEffect(()=>{R(V(S.pages[r]))},[a]),o.exports.useEffect(()=>{$&&ne()},[$]);const ne=()=>{if(h){const i=(M||0)%5,d=N+(i>0?1:0),b=a+1;if(b<d){A(b),Q(-1/0,b,r,y[r]);return}}const n=r+1;n<m&&Q(n,-1/0,r,y[r])},E=o.exports.useCallback(()=>n=>{_(i=>[...i,n])},[])(),R=n=>{D(w+n)},H=n=>{u(i=>i+n)},W=o.exports.useCallback(n=>(console.log(y),(y[r]||[]).find(d=>d.content.question===n)||null),[r]),se=(n,i)=>{switch(n.questionType){case"normal":return t(ge,{setAttempted:R,AddPageStudentPaperContent:K,setCorrectAnswersCount:H,AddLibraryPaperContents:E,question:n,savedQuestion:W(n._id),position:i+s,isMarked:p},i);case"comprehension":return t(Se,{setAttempted:R,index:i,savedQuestion:W(n._id),position:i+s,AddPageStudentPaperContent:K,question:n,AddLibraryPaperContents:E,setCorrectAnswersCount:H,isMarked:p},i);default:return t(me,{setAttempted:R,setCorrectAnswersCount:H,AddLibraryPaperContents:E,question:n,position:i+r*C,isMarked:p},i)}};return v("div",{style:{paddingTop:"0.3rem"},children:[v("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",border:"1px solid #d3d3d3",borderRadius:"2px",boxShadow:"0 4px 8px 0 rgba(0,0,0,0.2)",padding:"5px 6px",position:"sticky",top:62,zIndex:2},children:[t("button",{className:"waves-effect waves-light btn-small",disabled:r===0&&a===0,onClick:()=>{if(h&&a!==0){Q(-1/0,a>0?a-1:a,r,y[r]);return}let n=0;const i=r>0?r-1:r,d=S.pages[i];if(d&&d[0].questionType==="comprehension"){const b=d[0].content.children.length;n=Math.floor((b||0)/5)+((b||0)%5>0?1:0)}n-=n>0?1:0,Q(i,n,r,y[r])},children:t("i",{className:"material-icons",children:"arrow_back"})}),t("div",{hidden:!p,children:t("button",{disabled:(()=>{if(h){const n=(M||0)%5,i=N+(n>0?1:0);return a+1===i&&r+1===m}return r+1===m})(),onClick:()=>{if(h){const i=a+1;if(i<q){A(i);return}}const n=r+1;n<m&&g(n)},className:"waves-effect waves-light z-depth-1 btn-small",children:t("i",{className:"material-icons",children:"arrow_forward"})})})]}),t("div",{id:"zoeziPaper",children:t(de.Card,{style:{marginTop:"8px",border:"1px solid #d3d3d3"},header:v("div",{className:"card-image",children:[t("div",{className:"postergrad",children:t("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),t("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${k}`})]}),children:t("form",{onSubmit:n=>{if(n.preventDefault(),h)if(a<N){if(w!==5)return}else{const i=(M||0)%5;if(w!==i)return}else if(w!==M)return;O(!0),te&&P(!0)},children:e.map((n,i)=>se(n,i))})})})]})};export{Pe as default};
