var ae=Object.defineProperty,ce=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var q=(e,s,r)=>s in e?ae(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,V=(e,s)=>{for(var r in s||(s={}))de.call(s,r)&&q(e,r,s[r]);if(Y)for(var r of Y(s))ue.call(s,r)&&q(e,r,s[r]);return e},G=(e,s)=>ce(e,pe(s));import{r as o,R as ee}from"./vendor.fd4def91.js";import{j as H,M as te,l as ne}from"./App.b5b0e2d2.js";import{a as w,j as t,F as W}from"./index.d9930741.js";import{c as me}from"./millisecondsToTime.25c67ebb.js";const he=({option:e,_id:s,isCorrect:r,isMarked:g,index:x,position:n,setSuggestedAnswer:d,wasSelected:u})=>t("div",{children:t("p",{children:w("label",{children:[t("input",{type:"checkbox",className:"filled-in",disabled:g,checked:u||!1,onChange:S=>{d({option:e,isCorrect:r,_id:s})},name:`options_${n}`}),t("span",{className:g&&r?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e}})})})]})})},x),fe=({option:e,_id:s,isCorrect:r,isMarked:g,index:x,position:n,setSuggestedAnswer:d,wasSelected:u})=>t("div",{children:t("p",{children:w("label",{children:[t("input",{disabled:g,onChange:S=>{d({option:e,isCorrect:r,_id:s})},required:!0,checked:u||!1,className:"with-gap",name:`options_${n}`,type:"radio"}),t("span",{className:g&&r?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e}})})})]})})},x),ge=({question:e,position:s,isMarked:r,setAttempted:g,setCorrectAnswersCount:x,savedQuestion:n,AddPageStudentPaperContent:d})=>{const{currentPage:u,attemptTree:S}=o.exports.useContext(H),[l,a]=o.exports.useState([]),[m,y]=o.exports.useState(!1),b=o.exports.useMemo(()=>{var h,_;return((_=(h=e==null?void 0:e.options_next)==null?void 0:h.filter(C=>C.isCorrect))==null?void 0:_.length)||0},[e]),k=b>1||!1,M=h=>!!l.find(_=>_._id===h);o.exports.useEffect(()=>{let h=document.querySelectorAll(".question-comp img");te.Materialbox.init(h);let _=S.pages[u].find(f=>f.content.question===e._id);if(!_)return;let C=_.content,N=(e.options_next||[]).filter((f,p)=>C.attempted_options.findIndex(v=>v.optionID===f._id||v.optionIndex===p)>-1);y(N.length>0?N.every(f=>f.isCorrect):!1),a([...l,...N])},[]),o.exports.useEffect(()=>{l.length>0&&d(e._id,{questionType:"normal",content:{status:l.length>0?l.every(h=>h.isCorrect):!1,question:e._id,attempted_options:l.map(h=>({optionID:h._id,optionIndex:(e.options_next||[]).findIndex(_=>_._id===h._id)}))}})},[l]),o.exports.useEffect(()=>{if(r&&b===l.length){let h=l.length>0?l.every(_=>_.isCorrect):!1;y(h),x(h?1:0)}},[r]);const R=h=>{if(l.length||g(1),k){const _=l.findIndex(C=>C.option===h.option);if(_>-1){let C=[...l];C.splice(_),a(C),C.length||g(-1);return}a([...l,h]);return}a([h])},A=(()=>{let h=k?he:fe;return({position:_,index:C,_id:N,option:f,isCorrect:p,wasSelected:v})=>t(h,{_id:N,setSuggestedAnswer:R,position:_,option:f,index:C,isCorrect:p,isMarked:r,wasSelected:v},C)})();return w("div",{children:[t("span",{dangerouslySetInnerHTML:{__html:`
                    <div style="display:flex;flex-direction:row;">
                        ${r?m?'<span style="color:green;">&#10004;</span>':'<span style="color:red;">&#10008;</span>':""} 
                        <p style="margin-right:5px;">${s+1}.  </p><strong class="question-comp">${e.question}</strong>
                    </div>
                `}}),t("div",{style:{marginTop:"10px",marginLeft:"17px",marginBottom:"10px"},children:e.options_next&&e.options_next.map(({option:h,isCorrect:_,_id:C},N)=>A({position:s,_id:C,option:h,index:N,isCorrect:_,wasSelected:M(C)}))}),t("div",{style:{marginLeft:"17px",marginBottom:"10px"},hidden:!r,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                            ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},_e=({option:e,wasSelected:s,isCorrect:r,_id:g,isMarked:x,index:n,position:d,setAnswers:u,isMultiAnswersQuestion:S})=>t("div",{children:t("p",{children:w("label",{children:[t("input",{type:"checkbox",checked:s,className:"filled-in",disabled:x,onChange:l=>{u({option:e,isCorrect:r,_id:g})},required:!0,name:`sub_option_answer_${d}`}),t("span",{className:x&&r?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e}})})})]})})},n),xe=({option:e,wasSelected:s,isCorrect:r,_id:g,isMarked:x,keyValue:n,position:d,setAnswers:u,isMultiAnswersQuestion:S})=>t("p",{children:w("label",{children:[t("input",{disabled:x,checked:s,required:!0,onChange:l=>{u({option:e,isCorrect:r,_id:g})},className:"with-gap",type:"radio",name:`sub_option_answer_${d}`}),t("span",{className:x&&r?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e}})})})]})},n),be=({children:e,index:s,isMarked:r,isCorrect:g})=>w("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px",display:"flex",flexDirection:"row"},children:[r?g?t("span",{style:{color:"green"},children:"\u2714"}):t("span",{style:{color:"red"},children:"\u2718"}):null,s+1,".",t("div",{children:e})]}),Ce=({children:e,index:s})=>t("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px"},children:e}),ye=({question:e,index:s,AddInternalPaperContents:r,setAttempted:g,setCorrectAnswersCount:x,savedState:n,parentId:d})=>{const{attemptTree:u,currentPage:S,isMarked:l}=o.exports.useContext(H),[a,m]=o.exports.useState([]),[y,b]=o.exports.useState(!1),[k,M]=o.exports.useState(0);o.exports.useEffect(()=>{let f=u.pages[S].find(Q=>Q.content.question===d);if(!f)return;let v=f.content.children.find(Q=>Q.question===e._id);if(!v)return;let T=(e.options||[]).filter((Q,$)=>v?v.attempted_options.findIndex(E=>E.optionID===Q._id||E.optionIndex===$)>-1:!1);b(v.status),m([...a,...T])},[]),o.exports.useEffect(()=>{if(l&&a.length>0){let f=a.every(p=>p.isCorrect);b(f)}},[l,a]),o.exports.useEffect(()=>{k>0&&r({status:a.length?a.every(f=>f.isCorrect):!1,question:e._id,attempted_options:a.map(f=>({optionID:f._id,optionIndex:e.options.findIndex(p=>p._id===f._id)}))})},[k]);const R=o.exports.useMemo(()=>{var f,p;return((p=(f=e==null?void 0:e.options)==null?void 0:f.filter(v=>v.isCorrect))==null?void 0:p.length)>1},[e]),L=e.question.trim().replace(/(<([^>]+)>)/ig,"").trim().length<=1,A=f=>{if(a.length||g(1),R){let p=[...a],v=p.findIndex(T=>T._id===f._id);v>-1?p[v]=f:p.push(f),m(p)}else m([f]);M(p=>p+1)},h=L?be:Ce,C=(()=>{let f=R?_e:xe;return({position:p,index:v,option:T,isCorrect:Q,_id:$,quesIndex:E,wasSelected:B})=>t(f,{_id:$,wasSelected:B,keyValue:`sub_option_${v}_${E}`,setAnswers:A,isMultiAnswersQuestion:L,position:p,option:T,index:v,isCorrect:Q,isMarked:l},`sub_option_${v}_${E}`)})(),N=f=>!!a.find(p=>p._id===f||0);return w("div",{style:{marginLeft:"6px"},children:[t("span",{dangerouslySetInnerHTML:{__html:L?"":`
                        <div style="display:flex;flex-direction:row;">
                            <p style="margin-right:5px;">
                                ${l?y?'<span style="color:green;">&#10004;</span>':'<span style="color:red;">&#10008;</span>':""}${s+1}.  
                            </p>
                            <p><strong>
                            ${e.question}
                            </strong></p>
                        </div>
                    `}}),t(h,{index:s,isMarked:l,isCorrect:y,children:e.options.map(({option:f,isCorrect:p,_id:v},T)=>C({_id:v,position:s,index:s,quesIndex:T,option:f,wasSelected:N(v),isCorrect:p}))}),t("div",{style:{marginLeft:"15px",marginBottom:"10px"},hidden:!l,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                                ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},ve=e=>{let s=5,r=e.length%s,g=Math.floor(e.length/s)+(r>0?1:0),x=new Array(g).fill([]);for(let n=0;n<g;n++)x[n]=e.slice(n*s,n*s+s);return x},we=(e,s,r=0)=>(g,x=!1)=>{let n=[];return g.forEach(d=>{let u=d.attempted_options[0].optionID,S=d.attempted_options[0].optionIndex,l=d.question;for(let a=0;a<s.length;a++){let m=s[a];if(m._id===l){let y=m.options.find((b,k)=>b._id===u||k===S);y&&n.push({position:a+1+r,option:y.option,isCorrect:y.isCorrect});break}}}),n.reduce((d,u)=>d.replace(new RegExp(`_{2,4}\\s?${u.position}\\s?_{2,4}`),`<span style="color:${x&&u.isCorrect?"green":"red"};"><u><b>${u.option}</b></u></span>`),e)},Se=ee.memo(({parentId:e,position:s,sub_questions:r,AddInternalPaperContents:g,setCorrectAnswersCount:x,setAttempted:n,compSubQuestionPage:d,savedChildren:u})=>{const S=o.exports.useCallback(y=>u.find(b=>b.question===y)||null,[r]);let l=o.exports.useMemo(()=>ve(r||[]),[r]),a=l[d],m=l.slice(0,d).reduce((y,b)=>y+b.length,0);return t(W,{children:a.map((y,b)=>t(ye,{parentId:e,question:y,savedState:S(y._id),index:b+m+s,AddInternalPaperContents:g,setAttempted:n,setCorrectAnswersCount:x},b))})}),Ie=({question:e,isMarked:s,position:r,setAttempted:g,setCorrectAnswersCount:x,AddPageStudentPaperContent:n,savedQuestion:d})=>{const{compSubQuestionPage:u,currentPage:S,attemptTree:l}=o.exports.useContext(H),[a,m]=o.exports.useState([]),[y,b]=o.exports.useState([]),[k,M]=o.exports.useState(e.question),R=o.exports.useMemo(()=>e.children[0].question.trim().replace(/(<([^>]+)>)/ig,"").trim().length<=1,[e]),L=R?we(e.question,e.children,r):h=>e.question,A=h=>{let _=[...a],C=_.findIndex(N=>N.question===h.question);C>-1?_[C]=h:_=[..._,h],m(_)};return o.exports.useEffect(()=>{a.length>0&&(n(e._id,{questionType:"comprehension",content:{question:e._id,children:a}}),R&&M(L(a,s)))},[a]),o.exports.useEffect(()=>{let h=document.querySelectorAll(".question-comp img");te.Materialbox.init(h);let _=l.pages[S].find(N=>N.content.question===e._id);if(!_)return;let C=_.content;m(C.children),b(C.children)},[]),w("div",{children:[t("span",{dangerouslySetInnerHTML:{__html:`<div class="question-comp">${k}</div>`}}),t("div",{style:{marginTop:"5px"},children:t(Se,{AddInternalPaperContents:A,parentId:e._id,position:r,savedChildren:y,compSubQuestionPage:u,setAttempted:g,setCorrectAnswersCount:x,sub_questions:e.children||[]})})]})},Ae=({question:e,position:s,setAttempted:r,setCorrectAnswersCount:g,AddLibraryPaperContents:x,isMarked:n=!1})=>{const[d,u]=o.exports.useState(""),[S,l]=o.exports.useState(!1),a=b=>{const k=b.target.value;r(!d&&k?1:k?0:-1),u(b.target.value)},m=o.exports.useCallback(()=>d.toLocaleLowerCase()===e.answer.toLowerCase(),[d,e,n]),y=o.exports.useMemo(()=>e.subject.split(" ")[0].toLowerCase()==="kiswahili",[e]);return o.exports.useEffect(()=>{let b=m();l(b),g(b?1:0),x({questionType:"oldversion",content:{status:b,question:e._id,attempted_option:d}})},[n]),w("div",{className:"col s12",style:{marginBottom:"7px"},children:[w("div",{style:{display:"flex",flexDirection:"row"},children:[n?S?t("span",{style:{color:"green"},children:"\u2714"}):t("span",{style:{color:"red"},children:"\u2718"}):null,w("span",{style:{marginRight:"5px"},children:[s+1,". "]}),t("p",{children:w("span",{className:"left-align",children:[e.question,w("span",{className:"left-align",children:[t("br",{}),t("b",{children:e.options})]})]})})]}),w("div",{style:{marginLeft:"15px"},children:[w("div",{className:"input-field col s12",children:[t("input",{title:"Enter A B C or D",onChange:a,disabled:n,value:d,id:`trial_answer${s}`,required:!0,type:"text",className:"validate",style:{color:n?m()?"green":"red":"black"}}),t("label",{htmlFor:`trial_answer${s}`,children:y?"Jibu":"Answer"})]}),t("div",{hidden:!n,className:"col s12",children:t("blockquote",{className:"green lighten-5",style:{borderLeftColor:"#00e676"},children:w("p",{id:`correct_answer_display${s}`,className:"bold",children:[y?"Jibu Sahihi: ":"Correct Answer: ",e.answer]})})}),t("div",{hidden:!n,className:"col s12",children:t("blockquote",{className:"red lighten-5",children:t("p",{id:`additional_information${s}`,className:"bold",children:e.additionalInfo})})})]})]})},Te=ee.memo(({onTimeUp:e})=>{const{isMarked:s}=o.exports.useContext(H),[r,g]=o.exports.useState(+`${localStorage.getItem("remainingTime")}`||0),[x,n]=o.exports.useState(!1),d=o.exports.useMemo(()=>me(r<0?0:r),[r]);return o.exports.useEffect(()=>{if(r<=0){n(!0),s||e();return}localStorage.setItem("remainingTime",`${r>=0?r:0}`)},[r]),o.exports.useEffect(()=>{if(!x||!s){let u=setInterval(()=>{g(S=>S-1e3)},1e3);return()=>{clearInterval(u)}}},[x]),t(W,{children:t("button",{className:"waves-effect waves-light btn-small z-depth-0 white black-text",children:d})})}),Qe=({questions:e,alreadyDone:s,isKiswahili:r,wasTimed:g})=>{const{subject:x,currentPage:n,totalPages:d,attemptTree:u,questionsPerPage:S,numOfQuestions:l,isMarked:a,compSubQuestionPage:m,updatePageNumber:y,setIsMarked:b,setCurrentSubPage:k,updateStudentTreeContentAtAndMove:M}=o.exports.useContext(H),[R,L]=o.exports.useState(!1),[A,h]=o.exports.useState(0),[_,C]=o.exports.useState(0),[N,f]=o.exports.useState([]),[p,v]=o.exports.useState(e.length===1&&e[0].questionType?e[0].questionType==="comprehension":!1),[T,Q]=o.exports.useState({[n]:[]});let $=o.exports.useMemo(()=>{var i;return p?(i=e[0].children)==null?void 0:i.length:e.length},[n]),E=o.exports.useMemo(()=>p?Math.floor(($||0)/5)+(($||0)%5>0?1:0):0,[n]);const B=i=>i.reduce((c,I)=>{switch(I.questionType){case"normal":{c+=I.content.attempted_options.length>0?1:0;break}case"comprehension":{c+=I.content.children.slice(m*5,m*5+5).reduce((F,U)=>F+(U.attempted_options.length>0?1:0),0);break}}return c},0),J=i=>i.reduce((c,I)=>{switch(I.questionType){case"comprehension":{c+=I.content.children.slice(0,m>0?(m-1)*5+5:m).reduce((F,U)=>F+(U.attempted_options.length>0?1:0),0);break}}return c},0),se=o.exports.useMemo(()=>p?J(u.pages[n])+s+A:A+s,[A,n]),K=o.exports.useMemo(()=>p?J(u.pages[n])+s+A===l:A+s===l,[A,n,S,l]);let O=o.exports.useMemo(()=>p?Math.floor(($||0)/5):1,[e]);const Z=(i,c)=>{let I=T[n],P=I.findIndex(F=>F.content.question===i);if(P<0){Q({[n]:[...I,c]});return}I[P]=c,Q(G(V({},T),{[n]:I}))},re=o.exports.useMemo(()=>{if(p){let i=0,c=0;return m>O?(c=($||0)%5,i=O):i=m,i*5+c}return 0},[e]);o.exports.useEffect(()=>{let i=u.pages[n];j(B(i)),Q(G(V({},T),{[n]:i}))},[n]),o.exports.useEffect(()=>{j(B(u.pages[n]))},[m]),o.exports.useEffect(()=>{R&&oe()},[R]);const oe=()=>{if(p){let c=($||0)%5,I=O+(c>0?1:0),P=m+1;if(P<I){k(P),M(-1/0,P,n,T[n]);return}}let i=n+1;i<d&&M(i,-1/0,n,T[n])},z=o.exports.useCallback(()=>i=>{f(c=>[...c,i])},[])(),j=i=>{h(A+i)},D=i=>{C(c=>c+i)},X=o.exports.useCallback(i=>T[n].find(I=>I.content.question===i)||null,[n]),ie=(i,c)=>{switch(i.questionType){case"normal":return t(ge,{setAttempted:j,AddPageStudentPaperContent:Z,setCorrectAnswersCount:D,AddLibraryPaperContents:z,question:i,savedQuestion:X(i._id),position:c+s,isMarked:a},c);case"comprehension":return t(Ie,{setAttempted:j,index:c,savedQuestion:X(i._id),position:c+s,AddPageStudentPaperContent:Z,question:i,AddLibraryPaperContents:z,setCorrectAnswersCount:D,isMarked:a},c);default:return t(Ae,{setAttempted:j,setCorrectAnswersCount:D,AddLibraryPaperContents:z,question:i,position:c+n*S,isMarked:a},c)}};return w(W,{children:[w("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",borderRadius:"2px",boxShadow:"0 4px 8px 0 rgba(0,0,0,0.2)",padding:"5px 6px",position:"sticky",top:56.2,zIndex:2},children:[t("button",{className:"waves-effect waves-light btn-small",disabled:n===0&&m===0,onClick:()=>{if(p&&m!==0){M(-1/0,m>0?m-1:m,n,T[n]);return}let i=0,c=n>0?n-1:n,I=u.pages[c];if(I&&I[0].questionType==="comprehension"){let P=I[0].content.children.length;i=Math.floor((P||0)/5)+((P||0)%5>0?1:0)}i-=i>0?1:0,M(c,i,n,T[n])},children:t("i",{className:"material-icons",children:"arrow_back"})}),t("div",{className:"white",hidden:!a,style:{alignSelf:"center",padding:"5px",borderRadius:"3px",border:"1px solid #d3d3d3"},children:t("b",{children:w("span",{children:[r?"ALAMA":"SCORE"," : ",`${u.score.passed}/${l}`," ",w("span",{style:{fontFamily:"'Abril Fatface', cursive",color:"red"},children:["( ",Math.ceil(u.score.passed/u.score.total*100),"% )"]})]})})}),a?null:g?t(Te,{onTimeUp:()=>{b(!0)}}):t("input",{disabled:!0,type:"range",min:"0",value:`${se}`,max:l,style:{flex:1,marginRight:"3px",alignSelf:"center",background:"#000"}}),t("div",{hidden:a,className:"teal white-text z-depth-1",style:{alignSelf:"center",padding:"5px",borderRadius:"4px"},children:t("b",{children:`${A+s+re}/${l}`})}),t("div",{hidden:!a,children:t("button",{disabled:(()=>{if(p){let i=($||0)%5,c=O+(i>0?1:0);return m+1===c&&n+1===d}return n+1===d})(),onClick:()=>{if(p){let c=m+1;if(c<E){k(c);return}}let i=n+1;i<d&&y(i)},className:"waves-effect waves-light z-depth-1 btn-small",children:t("i",{className:"material-icons",children:"arrow_forward"})})})]}),t("div",{id:"zoeziPaper",children:t(ne.Card,{style:{marginTop:"13px"},header:w("div",{className:"card-image",children:[t("div",{className:"postergrad",children:t("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),t("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${x}`})]}),children:w("form",{onSubmit:i=>{if(i.preventDefault(),p)if(m<O){if(A!==5)return}else{let c=($||0)%5;if(A!==c)return}else if(A!==$)return;L(!0),K&&b(!0)},children:[e.map((i,c)=>ie(i,c)),t(ne.Button,{node:"button",waves:"light",small:!0,style:{marginTop:"15px"},disabled:a,children:K?r?"SAHIHISHA KARATASI":"MARK PAPER":r?"GEUZA UKURUSA":"TURN PAGE"})]})})})]})};export{Qe as default};
