var oe=Object.defineProperty,ie=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var U=(e,s,a)=>s in e?oe(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a,D=(e,s)=>{for(var a in s||(s={}))le.call(s,a)&&U(e,a,s[a]);if(J)for(var a of J(s))ce.call(s,a)&&U(e,a,s[a]);return e},V=(e,s)=>ie(e,ae(s));import{a as n}from"./vendor.0b632b43.js";import{n as H,R as X,z as Y,M as Z,l as pe}from"./App.a8681f4d.js";import{a as M,j as t,F as de}from"./index.1e4c208f.js";import{m as ue,g as me,O as he}from"./old_version_question.508aefe3.js";const fe=({option:e,index:s,position:a})=>t("div",{children:t("p",{children:M("label",{children:[t("input",{type:"checkbox",className:"filled-in",disabled:!0,checked:e.isCorrect,name:`options_${a}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},s),ge=({option:e,index:s,position:a})=>t("div",{children:t("p",{children:M("label",{children:[t("input",{disabled:!0,required:!0,checked:e.isCorrect,className:"with-gap",name:`options_${a}`,type:"radio"}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},s),_e=({question:e,position:s,isMarked:a,setAttempted:L,setCorrectAnswersCount:Q,savedQuestion:i,AddPageStudentPaperContent:b})=>{const{currentPage:w,attemptTree:T}=n.exports.useContext(H),u=X(Y),[p,c]=n.exports.useState([]),[C,_]=n.exports.useState(!1),I=n.exports.useMemo(()=>{var d,h;return((h=(d=e==null?void 0:e.options_next)==null?void 0:d.filter(l=>l.isCorrect))==null?void 0:h.length)||0},[e]),A=I>1||!1,P=n.exports.useRef(null);n.exports.useEffect(()=>{u&&u===e._id&&P.current&&window.scrollTo(0,P.current.offsetTop)},[u,e]),n.exports.useEffect(()=>{let d=document.querySelectorAll(".question-comp img");Z.Materialbox.init(d);let h=T.pages[w].find(g=>g.content.question===e._id);if(!h)return;let l=h.content,m=(e.options_next||[]).filter((g,x)=>l.attempted_options.findIndex(v=>v.optionID===g._id||v.optionIndex===x)>-1);_(m.length>0?m.every(g=>g.isCorrect):!1),c([...p,...m])},[]),n.exports.useEffect(()=>{p.length>0&&b(e._id,{questionType:"normal",content:{status:p.length>0?p.every(d=>d.isCorrect):!1,question:e._id,attempted_options:p.map(d=>({optionID:d._id,optionIndex:(e.options_next||[]).findIndex(h=>h._id===d._id)}))}})},[p]),n.exports.useEffect(()=>{if(a&&I===p.length){let d=p.length>0?p.every(h=>h.isCorrect):!1;_(d),Q(d?1:0)}},[a]);const y=(()=>{let d=A?fe:ge;return({position:h,index:l,option:m})=>t(d,{position:h,option:m,index:l},l)})();return M("div",{ref:P,style:{border:u===e._id?"1px solid red":"inherit",padding:u===e._id?"4px":"inherit"},children:[t("span",{dangerouslySetInnerHTML:{__html:`
                    <div style="display:flex;flex-direction:row;">
                        <p style="margin-right:5px;">${s+1}.  </p><strong class="question-comp">${e.question}</strong>
                    </div>
                `}}),t("div",{style:{marginTop:"10px",marginLeft:"17px",marginBottom:"10px"},children:e.options_next&&e.options_next.map((d,h)=>y({position:s,option:d,index:h}))}),t("div",{style:{marginLeft:"17px",marginBottom:"10px"},hidden:!a,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                            ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},xe=({option:e,index:s,position:a})=>t("div",{children:t("p",{children:M("label",{children:[t("input",{type:"checkbox",checked:e.isCorrect,className:"filled-in",disabled:!0,required:!0,name:`sub_option_answer_${a}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})})},s),be=({option:e,keyValue:s,position:a})=>t("p",{children:M("label",{children:[t("input",{disabled:!0,checked:e.isCorrect,required:!0,className:"with-gap",type:"radio",name:`sub_option_answer_${a}`}),t("span",{className:e.isCorrect?"green-text":"black-text",children:t("b",{children:t("span",{dangerouslySetInnerHTML:{__html:e.option}})})})]})},s),Ce=({children:e,index:s,isMarked:a,isCorrect:L})=>M("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px",display:"flex",flexDirection:"row"},children:[s+1,".",t("div",{children:e})]}),ye=({children:e,index:s})=>t("div",{style:{marginLeft:"15px",marginTop:"5px",marginBottom:"5px"},children:e}),ve=({question:e,index:s,AddInternalPaperContents:a,setAttempted:L,setCorrectAnswersCount:Q,savedState:i,parentId:b})=>{const{attemptTree:w,currentPage:T,isMarked:u}=n.exports.useContext(H),[p,c]=n.exports.useState([]),[C,_]=n.exports.useState(!1),[I,A]=n.exports.useState(0);n.exports.useEffect(()=>{let l=w.pages[T].find(v=>v.content.question===b);if(!l)return;let g=l.content.children.find(v=>v.question===e._id);if(!g)return;let x=(e.options||[]).filter((v,k)=>g?g.attempted_options.findIndex(R=>R.optionID===v._id||R.optionIndex===k)>-1:!1);_(g.status),c([...p,...x])},[]),n.exports.useEffect(()=>{if(u&&p.length>0){let l=p.every(m=>m.isCorrect);_(l)}},[u,p]),n.exports.useEffect(()=>{I>0&&a({status:p.length?p.every(l=>l.isCorrect):!1,question:e._id,attempted_options:p.map(l=>({optionID:l._id,optionIndex:e.options.findIndex(m=>m._id===l._id)}))})},[I]);const P=n.exports.useMemo(()=>{var l,m;return((m=(l=e==null?void 0:e.options)==null?void 0:l.filter(g=>g.isCorrect))==null?void 0:m.length)>1},[e]),N=e.question.trim().replace(/(<([^>]+)>)/ig,"").trim().length<=1,y=N?Ce:ye,h=(()=>{let l=P?xe:be;return({position:m,index:g,option:x,quesIndex:v})=>t(l,{keyValue:`sub_option_${g}_${v}`,position:m,option:x,index:g},`sub_option_${g}_${v}`)})();return M("div",{style:{marginLeft:"6px"},children:[t("span",{dangerouslySetInnerHTML:{__html:N?"":`
                        <div style="display:flex;flex-direction:row;">
                            <p style="margin-right:5px;">${s+1}.</p>
                            <p><strong>${e.question}</strong></p>
                        </div>
                    `}}),t(y,{index:s,isMarked:u,isCorrect:C,children:e.options.map((l,m)=>h({position:s,index:s,quesIndex:m,option:l}))}),t("div",{style:{marginLeft:"15px",marginBottom:"10px"},hidden:!u,children:t("span",{dangerouslySetInnerHTML:{__html:`
                        <blockquote class="red lighten-5">
                            <span>
                                ${e.additionalInfo}
                            </span>
                        </blockquote>
                    `}})})]})},Se=({parentId:e,position:s,sub_questions:a,setCorrectAnswersCount:L,setAttempted:Q,savedChildren:i})=>{const{compSubQuestionPage:b,currentPage:w}=n.exports.useContext(H),T=n.exports.useCallback(C=>i.find(_=>_.question===C)||null,[a]);let u=n.exports.useMemo(()=>me(a||[]),[a]),p=u[b],c=u.slice(0,b).reduce((C,_)=>C+_.length,0);return t(de,{children:p.map((C,_)=>t(ve,{parentId:e,question:C,savedState:T(C._id),index:_+c+s,AddInternalPaperContents:I=>{},setAttempted:Q,setCorrectAnswersCount:L},_))})},we=({question:e,isMarked:s,position:a,setAttempted:L,setCorrectAnswersCount:Q})=>{const{compSubQuestionPage:i,currentPage:b,attemptTree:w}=n.exports.useContext(H),T=X(Y),[u,p]=n.exports.useState([]),[c,C]=n.exports.useState([]),[_,I]=n.exports.useState(e.question),[A,P]=n.exports.useState(-1),N=n.exports.useMemo(()=>e.children[0].question.trim().replace(/(<([^>]+)>)/ig,"").trim().length<=1,[e]),y=N?ue(e.question,e.children,a):d=>e.question;return n.exports.useEffect(()=>{u.length>0&&N&&I(y(u,s))},[u]),n.exports.useEffect(()=>{let d=document.querySelectorAll(".question-comp img");Z.Materialbox.init(d);let h=w.pages[b].find(m=>m.content.question===e._id);if(!h)return;let l=h.content;p(l.children),C(l.children)},[]),n.exports.useEffect(()=>{P(Math.random()),console.log(`The current sub page is ${i}`)},[b]),M("div",{style:{border:T===e._id?"1px solid red":"inherit",padding:T===e._id?"4px":"inherit"},children:[t("span",{dangerouslySetInnerHTML:{__html:`<div class="question-comp">${_}</div>`}}),t("div",{style:{marginTop:"5px"},children:t(Se,{parentId:e._id,position:a,savedChildren:c,setAttempted:L,setCorrectAnswersCount:Q,sub_questions:e.children||[]},A)})]})},Ae=({questions:e,alreadyDone:s,isKiswahili:a,wasTimed:L})=>{const{subject:Q,currentPage:i,totalPages:b,attemptTree:w,questionsPerPage:T,numOfQuestions:u,isMarked:p,compSubQuestionPage:c,updatePageNumber:C,setIsMarked:_,setCurrentSubPage:I,updateStudentTreeContentAtAndMove:A}=n.exports.useContext(H),[P,N]=n.exports.useState(!1),[y,d]=n.exports.useState(0),[h,l]=n.exports.useState(0),[m,g]=n.exports.useState([]),[x,v]=n.exports.useState(e.length===1&&e[0].questionType?e[0].questionType==="comprehension":!1),[k,R]=n.exports.useState({[i]:[]});let $=n.exports.useMemo(()=>{var r;return x?(r=e[0].children)==null?void 0:r.length:e.length},[i]),q=n.exports.useMemo(()=>x?Math.floor(($||0)/5)+(($||0)%5>0?1:0):0,[i]);const G=n.exports.useCallback(r=>r.reduce((o,f)=>{switch(f.questionType){case"normal":{o+=f.content.attempted_options.length>0?1:0;break}case"comprehension":{o+=f.content.children.slice(c*5,c*5+5).reduce((j,B)=>j+(B.attempted_options.length>0?1:0),0);break}}return o},0),[c]),ee=n.exports.useCallback(r=>r.reduce((o,f)=>{switch(f.questionType){case"comprehension":{o+=f.content.children.slice(0,c>0?(c-1)*5+5:c).reduce((j,B)=>j+(B.attempted_options.length>0?1:0),0);break}}return o},0),[c]),te=n.exports.useMemo(()=>x?ee(w.pages[i])+s+y===u:y+s===u,[y,i,T,u]);let O=n.exports.useMemo(()=>x?Math.floor(($||0)/5):1,[e]);const K=(r,o)=>{let f=k[i],S=f.findIndex(j=>j.content.question===r);if(S<0){R({[i]:[...f,o]});return}f[S]=o,R(V(D({},k),{[i]:f}))};n.exports.useMemo(()=>{if(x){let r=0,o=0;return c>O?(o=($||0)%5,r=O):r=c,r*5+o}return 0},[e]),n.exports.useEffect(()=>{let r=w.pages[i];E(G(r)),R(V(D({},k),{[i]:r}))},[i]),n.exports.useEffect(()=>{E(G(w.pages[i]))},[c]),n.exports.useEffect(()=>{P&&ne()},[P]);const ne=()=>{if(x){let o=($||0)%5,f=O+(o>0?1:0),S=c+1;if(S<f){I(S),A(-1/0,S,i,k[i]);return}}let r=i+1;r<b&&A(r,-1/0,i,k[i])},F=n.exports.useCallback(()=>r=>{g(o=>[...o,r])},[])(),E=r=>{d(y+r)},z=r=>{l(o=>o+r)},W=n.exports.useCallback(r=>(console.log(k),(k[i]||[]).find(f=>f.content.question===r)||null),[i]),re=(r,o)=>{switch(r.questionType){case"normal":return t(_e,{setAttempted:E,AddPageStudentPaperContent:K,setCorrectAnswersCount:z,AddLibraryPaperContents:F,question:r,savedQuestion:W(r._id),position:o+s,isMarked:p},o);case"comprehension":return t(we,{setAttempted:E,index:o,savedQuestion:W(r._id),position:o+s,AddPageStudentPaperContent:K,question:r,AddLibraryPaperContents:F,setCorrectAnswersCount:z,isMarked:p},o);default:return t(he,{setAttempted:E,setCorrectAnswersCount:z,AddLibraryPaperContents:F,question:r,position:o+i*T,isMarked:p},o)}};return M("div",{style:{paddingTop:"0.3rem"},children:[M("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",border:"1px solid #d3d3d3",borderRadius:"2px",boxShadow:"0 4px 8px 0 rgba(0,0,0,0.2)",padding:"5px 6px",position:"sticky",top:62,zIndex:2},children:[t("button",{className:"waves-effect waves-light btn-small",disabled:i===0&&c===0,onClick:()=>{if(x&&c!==0){A(-1/0,c>0?c-1:c,i,k[i]);return}let r=0,o=i>0?i-1:i,f=w.pages[o];if(f&&f[0].questionType==="comprehension"){let S=f[0].content.children.length;r=Math.floor((S||0)/5)+((S||0)%5>0?1:0)}r-=r>0?1:0,A(o,r,i,k[i])},children:t("i",{className:"material-icons",children:"arrow_back"})}),t("div",{hidden:!p,children:t("button",{disabled:(()=>{if(x){let r=($||0)%5,o=O+(r>0?1:0);return c+1===o&&i+1===b}return i+1===b})(),onClick:()=>{if(x){let o=c+1;if(o<q){I(o);return}}let r=i+1;r<b&&C(r)},className:"waves-effect waves-light z-depth-1 btn-small",children:t("i",{className:"material-icons",children:"arrow_forward"})})})]}),t("div",{id:"zoeziPaper",children:t(pe.Card,{style:{marginTop:"8px",border:"1px solid #d3d3d3"},header:M("div",{className:"card-image",children:[t("div",{className:"postergrad",children:t("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),t("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${Q}`})]}),children:t("form",{onSubmit:r=>{if(r.preventDefault(),x)if(c<O){if(y!==5)return}else{let o=($||0)%5;if(y!==o)return}else if(y!==$)return;N(!0),te&&_(!0)},children:e.map((r,o)=>re(r,o))})})})]})};export{Ae as default};
