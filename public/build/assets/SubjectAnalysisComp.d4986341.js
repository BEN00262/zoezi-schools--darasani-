import{C as A,a as L,L as P,B as j,p as R,b as k,c as B,G as _,u as D,d as m,S as b,e as E}from"./App.7283f78f.js";import{r}from"./vendor.fd4def91.js";import{a as l,j as e}from"./index.3350170c.js";A.register(L,P,j,R,k,B);const I=(d,o)=>({indexAxis:o?"y":"x",responsive:!0,maintainAspectRatio:!1,redraw:!0,plugins:{legend:{position:"top"},title:{display:!0,text:d},barValueSpacing:40,tooltips:{displayColors:!0,callbacks:{mode:"x"}},datalabels:{display:u=>!1},scales:{xAxes:[{gridLines:{display:!0,drawBorder:!1}}],yAxes:[{gridLines:{display:!1,drawBorder:!0}}]}}}),O=({subject:d})=>{const{authToken:o}=r.exports.useContext(_),u=D(),[f,x]=r.exports.useState([]),[g,v]=r.exports.useState([]),[i,N]=r.exports.useState(""),[c,S]=r.exports.useState({firstname:"",lastname:"",profilePic:""}),[n,y]=r.exports.useState({isSpecial:!1,label:"",value:""}),[p,C]=r.exports.useState([]),[h,$]=r.exports.useState({pass:[],fail:[]}),w=!1;return r.exports.useEffect(()=>{const a=localStorage.getItem("classRefId")||"";m.get(`/api/grade/learners/${a}`,{headers:{Authorization:`Bearer ${o}`}}).then(({data:s})=>{if(s){x(s.learners.map(t=>({label:`${t.firstname} ${t.lastname}`,value:t._id})));return}})},[]),r.exports.useEffect(()=>{n.value&&m.get(`/api/analytics/learner/${i}/${n.value}${n.isSpecial?"/special":""}`,{headers:{Authorization:`Bearer ${o}`}}).then(({data:a})=>{if(a){let s=a.plottable;$({pass:s.map(t=>t.score.passed),fail:s.map(t=>t.score.total-t.score.passed)}),C(s);return}})},[n]),r.exports.useEffect(()=>{if(i){const a=localStorage.getItem("classId")||"";m.get(`/api/analytics/subject/${a}/${i}/${d}`,{headers:{Authorization:`Bearer ${o}`}}).then(({data:s})=>{if(s){S(s.student),v(s.papersDone.map(t=>({label:t.subject,value:t.paperID,isSpecial:t.isSpecial})));return}})}},[i]),l("div",{className:"row",children:[c.firstname?e("div",{className:"col s12 center",children:l("div",{style:{margin:"auto"},children:[e("img",{style:{height:"100px",width:"100px",objectFit:"contain",border:"1px solid #d3d3d3",borderRadius:"50%"},src:c.profilePic?c.profilePic:"https://cdn2.iconfinder.com/data/icons/child-people-face-avatar-3/500/child_152-512.png"}),e("br",{}),e("span",{className:"sub-modal-texts",style:{letterSpacing:"1px"},children:l("b",{children:[c.firstname," ",c.lastname]})})]})}):null,e("div",{className:"col s12 m12 l4",children:e("div",{className:"card z-depth-0",style:{border:"1px solid #dcdee2"},children:l("div",{className:"card-content",children:[l("div",{className:"row",children:[l("div",{className:"col s12 m12",children:[e("label",{children:"Learner"}),e(b,{onChange:a=>{N((a==null?void 0:a.value)||"")},options:f,placeholder:"select learner..."})]}),l("div",{className:"col s12 m12",children:[e("label",{children:"Paper"}),e(b,{options:g,onChange:a=>{y(a||{})},placeholder:"select paper..."})]})]}),e("div",{className:"row",id:"performanceReportButton",hidden:!0,children:e("div",{className:"col s12 m12",children:l("button",{onClick:()=>{},"data-position":"bottom","data-tooltip":"Scroll down to view or download the report",className:"btn-small sub-modal-texts tooltipped white black-text waves-effect waves-black z-depth-1",style:{width:"100%",fontWeight:"bold"},children:["PERFORMANCE REPORT",e("i",{className:"material-icons right",children:"assessment"})]})})})]})})}),e("div",{className:"col s12 m12 l8",children:e("div",{className:"card z-depth-0",style:{border:"1px solid #dcdee2"},children:e("div",{className:"card-content",children:e("div",{className:"row",id:"insertChart",children:e(E,{options:I("Performance Analysis",w),style:{height:"300px"},data:{labels:h.pass.map((a,s)=>`Attempt ${s+1}`),datasets:[{label:"Pass",data:h.pass,backgroundColor:"#00c853"},{label:"Fail",data:h.fail,backgroundColor:"#f44336"}]}})})})})}),p.length?l("div",{className:"col s12 m12",children:[e("h3",{className:"hide-on-small-only",children:e("i",{className:"mdi-content-send brown-text"})}),l("h5",{className:"center sub-sub-headings",children:["Last (",p.length,") paper(s)"]}),e("div",{className:"divider"}),e("div",{className:"section",children:p.map((a,s)=>e("div",{className:"col s6 m2 l2",children:e("div",{className:"hoverable",onClick:t=>u(a.isSpecial?`/library-paper/special/${i}/${a.grade}/${a.paperID}/${a._id}`:`/library-paper/${i}/${a._id}`),style:{backgroundColor:"#fffde7",marginBottom:"5px",cursor:"pointer",border:"1px solid #d3d3d3",borderRadius:"2px",padding:"4px"},children:l("div",{className:"center",children:[e("span",{className:"sub-names truncate",children:e("b",{children:a.subject})}),e("br",{}),e("span",{className:"sub-modal-texts teal-text truncate",style:{backgroundColor:"#fff",border:"1px solid #d3d3d3",padding:"4px",borderRadius:"2px"},children:l("b",{children:[a.subject.split(" ")[0].toLocaleLowerCase().includes("kiwahili")?"ALAMA":"SCORE","(",a.score.passed,"/",a.score.total,")"]})})]})})},s))})]}):null]})};export{O as default,I as options};
