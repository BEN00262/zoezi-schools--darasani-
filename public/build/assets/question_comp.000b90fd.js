var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var O=(o,n,u)=>n in o?ee(o,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[n]=u,N=(o,n)=>{for(var u in n||(n={}))ne.call(n,u)&&O(o,u,n[u]);if(L)for(var u of L(n))re.call(n,u)&&O(o,u,n[u]);return o},A=(o,n)=>te(o,se(n));import{a as i}from"./vendor.0b632b43.js";import{n as oe,l as ie}from"./App.a8681f4d.js";import{T as ae,N as le}from"./TimerComp.d3d46367.js";import{O as pe,C as ue}from"./old_version_question.508aefe3.js";import{a as Q,F as ce,j as a}from"./index.1e4c208f.js";import"./millisecondsToTime.6095074a.js";const ve=({questions:o,alreadyDone:n,isKiswahili:u,wasTimed:R})=>{const{subject:G,currentPage:s,totalPages:w,attemptTree:g,questionsPerPage:j,numOfQuestions:_,isMarked:h,compSubQuestionPage:l,updatePageNumber:k,setIsMarked:M,setCurrentSubPage:z,updateStudentTreeContentAtAndMove:v}=i.exports.useContext(oe),[I,H]=i.exports.useState(!1),[c,K]=i.exports.useState(0),[de,U]=i.exports.useState(0),[me,V]=i.exports.useState([]),[d,fe]=i.exports.useState(o.length===1&&o[0].questionType?o[0].questionType==="comprehension":!1),[m,P]=i.exports.useState({[s]:[]});let f=i.exports.useMemo(()=>{var e;return d?(e=o[0].children)==null?void 0:e.length:o.length},[s]),W=i.exports.useMemo(()=>d?Math.floor((f||0)/5)+((f||0)%5>0?1:0):0,[s]);const F=e=>e.reduce((t,r)=>{switch(r.questionType){case"normal":{t+=r.content.attempted_options.length>0?1:0;break}case"comprehension":{t+=r.content.children.slice(l*5,l*5+5).reduce((C,S)=>C+(S.attempted_options.length>0?1:0),0);break}}return t},0),$=e=>e.reduce((t,r)=>{switch(r.questionType){case"comprehension":{t+=r.content.children.slice(0,l>0?(l-1)*5+5:l).reduce((C,S)=>C+(S.attempted_options.length>0?1:0),0);break}}return t},0),B=i.exports.useMemo(()=>d?$(g.pages[s])+n+c:c+n,[c,s]),J=i.exports.useMemo(()=>d?$(g.pages[s])+n+c===_:c+n===_,[c,s,j,_]);let b=i.exports.useMemo(()=>d?Math.floor((f||0)/5):1,[o]);const q=(e,t)=>{let r=m[s],p=r.findIndex(C=>C.content.question===e);if(p<0){P({[s]:[...r,t]});return}r[p]=t,P(A(N({},m),{[s]:r}))},X=i.exports.useMemo(()=>{if(d){let e=0,t=0;return l>b?(t=(f||0)%5,e=b):e=l,e*5+t}return 0},[o]);i.exports.useEffect(()=>{let e=g.pages[s];x(F(e)),P(A(N({},m),{[s]:e}))},[s]),i.exports.useEffect(()=>{x(F(g.pages[s]))},[l]),i.exports.useEffect(()=>{I&&Y()},[I]);const Y=()=>{if(d){let t=(f||0)%5,r=b+(t>0?1:0),p=l+1;if(p<r){z(p),v(-1/0,p,s,m[s]);return}}let e=s+1;e<w&&v(e,-1/0,s,m[s])},T=i.exports.useCallback(()=>e=>{V(t=>[...t,e])},[])(),x=e=>{K(c+e)},y=e=>{U(t=>t+e)},E=i.exports.useCallback(e=>(m[s]||[]).find(r=>r.content.question===e)||null,[s]),Z=(e,t)=>{switch(e.questionType){case"normal":return a(le,{setAttempted:x,AddPageStudentPaperContent:q,setCorrectAnswersCount:y,AddLibraryPaperContents:T,question:e,savedQuestion:E(e._id),position:t+n,isMarked:h},t);case"comprehension":return a(ue,{setAttempted:x,index:t,savedQuestion:E(e._id),position:t+n,AddPageStudentPaperContent:q,question:e,AddLibraryPaperContents:T,setCorrectAnswersCount:y,isMarked:h},t);default:return a(pe,{setAttempted:x,setCorrectAnswersCount:y,AddLibraryPaperContents:T,question:e,position:t+s*j,isMarked:h},t)}};return Q(ce,{children:[Q("div",{className:"white",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",borderRadius:"2px",padding:"5px 6px",border:"1px solid #d3d3d3",position:"sticky",top:64,zIndex:2},children:[a("button",{className:"waves-effect waves-light btn-small z-depth-0",disabled:s===0&&l===0,onClick:()=>{if(d&&l!==0){v(-1/0,l>0?l-1:l,s,m[s]);return}let e=0,t=s>0?s-1:s,r=g.pages[t];if(r&&r[0].questionType==="comprehension"){let p=r[0].content.children.length;e=Math.floor((p||0)/5)+((p||0)%5>0?1:0)}e-=e>0?1:0,v(t,e,s,m[s]),k(t)},children:a("i",{className:"material-icons",children:"arrow_back"})}),h?null:R?a(ae,{onTimeUp:()=>{M(!0)}}):a("input",{disabled:!0,type:"range",min:"0",value:`${B}`,max:_,style:{flex:1,marginRight:"3px",alignSelf:"center",background:"#000"}}),a("div",{hidden:h,className:"teal white-text z-depth-1",style:{alignSelf:"center",padding:"5px",borderRadius:"4px"},children:a("b",{children:`${c+n+X}/${_}`})}),a("div",{hidden:!h,children:a("button",{disabled:(()=>{if(d){let e=(f||0)%5,t=b+(e>0?1:0);return l+1===t&&s+1===w}return s+1===w})(),onClick:()=>{if(d){let t=l+1;if(t<W){z(t);return}}let e=s+1;e<w&&k(e)},className:"waves-effect waves-light z-depth-0 btn-small",children:a("i",{className:"material-icons",children:"arrow_forward"})})})]}),a("div",{id:"zoeziPaper",children:a(ie.Card,{style:{marginTop:"13px",border:"1px solid #d3d3d3"},className:"z-depth-0",header:Q("div",{className:"card-image",children:[a("div",{className:"postergrad",children:a("img",{alt:"",style:{maxWidth:"100%",height:"84px",objectFit:"cover"},src:"https://www.zoezi-education.com/img/background2.webp"})}),a("span",{className:"card-title text-center sub-names truncate text-bold teal",children:`${G}`})]}),children:a("form",{onSubmit:e=>{if(e.preventDefault(),d)if(l<b){if(c!==5)return}else{let t=(f||0)%5;if(c!==t)return}else if(c!==f)return;H(!0),J&&M(!0)},children:o.map((e,t)=>Z(e,t))})})})]})};export{ve as default};
